<!DOCTYPE html>
<html>
<head>
    <title>Debug Bonificación</title>
    <link rel="stylesheet" href="vendor/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <style>
        body { padding: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        .btn { margin: 5px; }
        .debug-output { background: #e9ecef; padding: 10px; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Debug Campo Bonificación</h1>
    
    <!-- Formulario de prueba -->
    <div class="debug-section">
        <h3>Formulario de Prueba</h3>
        <form>
            <div class="form-group">
                <label for="test_bonificacion">Bonificación:</label>
                <input type="number" id="test_bonificacion" ng-model="test_bonificacion" class="form-control" placeholder="Ingrese bonificación">
            </div>
            <button type="button" class="btn btn-primary" onclick="setTestValue()">Establecer Valor 123</button>
            <button type="button" class="btn btn-warning" onclick="getTestValue()">Obtener Valor</button>
            <button type="button" class="btn btn-info" onclick="testNgModel()">Probar ng-model</button>
        </form>
    </div>
    
    <div id="debug-output" class="debug-output">
        <h4>Debug Output:</h4>
        <div id="debug-content"></div>
    </div>
    
    <!-- Scripts -->
    <script src="vendor/angular/angular.min.js"></script>
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
    <script src="js/jerarquia.js"></script>
    
    <script>
        function log(message) {
            console.log(message);
            document.getElementById('debug-content').innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }
        
        function setTestValue() {
            log('=== ESTABLECIENDO VALOR DE PRUEBA ===');
            var scope = angular.element(document.body).scope();
            if (scope) {
                scope.test_bonificacion = 123;
                scope.$apply();
                log('Valor establecido en scope: ' + scope.test_bonificacion);
                
                // También establecer en el campo directamente
                var field = document.getElementById('test_bonificacion');
                if (field) {
                    field.value = 123;
                    log('Valor establecido en campo: ' + field.value);
                }
            }
        }
        
        function getTestValue() {
            log('=== OBTENIENDO VALOR ===');
            var scope = angular.element(document.body).scope();
            if (scope) {
                log('Valor en scope: ' + scope.test_bonificacion);
            }
            
            var field = document.getElementById('test_bonificacion');
            if (field) {
                log('Valor en campo: ' + field.value);
            }
        }
        
        function testNgModel() {
            log('=== PROBANDO NG-MODEL ===');
            var field = document.getElementById('test_bonificacion');
            if (field) {
                log('ng-model del campo: ' + field.getAttribute('ng-model'));
                log('Tipo de campo: ' + field.type);
                log('Valor actual: ' + field.value);
            }
        }
        
        // Interceptar console.log
        var originalLog = console.log;
        console.log = function(message) {
            originalLog.apply(console, arguments);
            if (typeof message === 'string' && (message.includes('bonificacion') || message.includes('Bonificación'))) {
                document.getElementById('debug-content').innerHTML += '<div style="color: blue;">' + message + '</div>';
            }
        };
        
        // Inicializar cuando la página cargue
        document.addEventListener('DOMContentLoaded', function() {
            log('Página de debug cargada');
        });
    </script>
</body>
</html>

